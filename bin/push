#!/usr/bin/env python2.7

"""
This is the main entry point for the push library. To use this you should drop
a .pushrc file into your project's directory. Then you can run ``push -l`` and
see what options are available.
"""

import os
import sys
from subprocess import call

# damn do i hate pyc files
sys.dont_write_bytecode = True

# find out the path of our current script
# this is where our other helpers are
path = os.path.dirname(os.path.realpath(__file__))

# these are the things we're going to run
args = [
    # the python executable that we're already running
    sys.executable,

    # our replacement for the fab executable
    "{}/fabrunner.py".format(path),

    # our way to force fabric to load from .pushrc files
    "-f", "{}/fabloader.py".format(path),
]

# add the user's arguments from the command line
# ignore the first part of argv which just has this program's name in it
args += sys.argv[1:]

# now call our fabric replacement
call(args)
